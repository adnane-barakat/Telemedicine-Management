<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title>Gestion des suivis des patients</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
        <!-- font awesome -->
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw==" crossorigin="anonymous" referrerpolicy="no-referrer" />
        <!-- owl carousel -->
         
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/assets/owl.carousel.min.css" integrity="sha512-tS3S5qG0BlhnQROyJXvNjeEM4UpMXHrQfTGmbQ1gKmelCxlSEBUaxhRBj/EFTzpbP4RVSrpEikbmdJobCvhE3g==" crossorigin="anonymous" referrerpolicy="no-referrer" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/assets/owl.theme.default.min.css" integrity="sha512-sMXtMNL1zRzolHYKEujM2AqCLUR9F2C4/05cdbxjjLSRvMQIciEPCQZo++nk7go3BtSuK9kfa/s+a4f4i5pLkw==" crossorigin="anonymous" referrerpolicy="no-referrer" />
        <!-- custom css -->
         
        <link rel = "stylesheet" href = "assets/css/main.css" />
        <link rel = "stylesheet" href = "assets/css/utilities.css" />
        <!-- normalize.css -->
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css" integrity="sha512-NhSC1YmyruXifcj/KFRWoC561YpHpc5Jtzgvbuzx5VozKpWvQ+4nXhPdFgmx8xqexRcpAglTj9sIBWINXa8x5w==" crossorigin="anonymous" referrerpolicy="no-referrer" />
        

<style>

input, button {
    width: 100%;
    padding: 10px;
    margin: 5px 0;
    font-size: 16px;
}

</style>



    </head>
    <body>
        
        <div class="page-wrapper">
            <!-- header -->
            <header class = "header">
                <nav class = "navbar">
                    <div class="container">
                        <div class="navbar-content d-flex justify-content-between align-items-center">
                            <div class = "brand-and-toggler d-flex align-items-center justify-content-between">
                                <a href = "#" class = "navbar-brand d-flex align-items-center">
                                    <span class="brand-shape d-inline-block text-white">GC</span>
                                    <span class="brand-text fw-7">Gestion Clinique</span>
                                </a>
                                <button type = "button" class = "d-none navbar-show-btn">
                                    <i class = "fas fa-bars"></i>
                                </button>
                            </div>

                            <div class = "navbar-box">
                                <button type = "button" class = "navbar-hide-btn">
                                    <i class = "fas fa-times"></i>
                                </button>

                               
                                </ul>
                            </div>
                        </div>
                    </div>
                </nav>

                <div class="element-one">
                    <img src = "assets/images/element-img-1.png" alt = "">
                </div>

                <div class="banner">
                    <div class="container">
                        <div class="banner-content">
                            <div class="banner-left">
                                <div class="content-wrapper">
                                    <h1 class="banner-title">Bienvenue sur la plateforme !</h1>
                                    <p class="text text-white">Gestion Clinique est une application intuitive et performante conçue pour simplifier la gestion des patients, médecins, dossiers médicaux, prescriptions, des rendez-vous,des notifications et des suivis des patients. Développée avec la technologie SOAP et REST, cette plateforme garantit une communication fiable et standardisée entre les différents services, tout en assurant la sécurité et l'intégrité des données.</p>
                                    <a href = "#sc-services" class="btn btn-light" style="font-weight:bold!important;color:black!important;">Commencer la Gestion des suivis des patients !</a>
                                </div>
                            </div>

                            <div class = "banner-right d-flex align-items-center justify-content-end">
                                <img src = "assets/images/banner-image.png" alt = "">
                            </div>
                        </div>
                    </div>
                </div>
            </header>
            <!-- end of header -->

            <main>
                <section class = "sc-services" id="sc-services">
                    <div class = "services-shape">
                        <img src = "assets/images/curve-shape-1.png" alt = "">
                    </div>
                    <div class="container">
                        <div class = "services-content">
                            <div class="title-box text-center">
                                <div class = "content-wrapper">
                                    <h3 class = "title-box-name">Gestions des suivis des patients</h3>
                                    <div class = "title-separator mx-auto"></div>
                                   
                                </div>
                            </div>

                            


                            <section>
                                <!-- Formulaire pour consulter l'historique des consultations -->
                                <form id="historiqueConsultationForm">
                                    <label for="idDossier">ID du Dossier:</label>
                                    <input type="number" id="idDossier" required>
                                    <button class="alert alert-primary" style="font-weight:bold;" type="submit">Afficher Historique des Consultations</button>
                                </form>
                            
                                <!-- Formulaire pour afficher les rapports -->
                                <form id="affichageRapportForm">
                                    <label for="idDossierRapport">ID du Dossier:</label>
                                    <input type="number" id="idDossierRapport" required>
                                    <button class="alert alert-info" style="font-weight:bold;" type="submit">Afficher Rapports</button>
                                </form>
                            
                                <!-- Formulaire pour changer le statut d'un rendez-vous -->
                                <form id="changerStatusForm">
                                    <label for="idRendezVous">ID du Rendez-vous:</label>
                                    <input type="number" id="idRendezVous" required>
                                    <button class="alert alert-warning" style="font-weight:bold;" type="submit">Changer Statut du Rendez-vous</button>
                                </form>
                            
                                <!-- Résultat des actions -->
                                <pre class="alert alert-secondary" style="font-weight:bold;" id="result"></pre>
                            </section>
                                

        
            </main>

            <footer class = "footer" id="footer">
                <div class = "container">
                    <div class = "footer-content">
                        <div class = "footer-list d-grid text-white">
                            <div class = "footer-item">
                                <a href = "#" class = "navbar-brand d-flex align-items-center">
                                    <span class = "brand-shape d-inline-block text-white">GC</span>
                                    <span class = "brand-text fw-7">Gestion Clinique</span>
                                </a>
                                <p class = "text-white">Gestion Clinique est une application intuitive et performante conçue pour simplifier la gestion des patients, médecins, dossiers médicaux, prescriptions, des rendez-vous,des notifications et des suivis des patients.</p>
                                <p class = "text-white copyright-text">&copy; Gestion Clinique 2024. All rights reserved.</p>
                            </div>

                            <div class = "footer-item">
                                <h3 class = "footer-item-title">Company</h3>
                                <ul class = "footer-links">
                                    <li><a href = "index.html">Home</a></li>
                                    <li><a href = "index.html#sc-services">Services</a></li>
                                   
                                </ul>
                            </div>

                            <div class = "footer-item">
                                <h3 class = "footer-item-title">Region</h3>
                                <ul class = "footer-links">
                                    <li><a >Rabat</a></li>
                                    <li><a >Casa</a></li>
                                    <li><a >Fes</a></li>
                                    <li><a >Meknes</a></li>
                                </ul>
                            </div>

                            <div class = "footer-item">
                                <h3 class = "footer-item-title">Contact</h3>
                                <ul class = "footer-links">
                                    <li><a >+212 06 83 43 28 43</a></li>
                                    <li><a >contact@gc.ma</a></li>
                                    
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>

                <div class = "footer-element-1">
                    <img src = "assets/images/element-img-4.png" alt = "">
                </div>
                <div class = "footer-element-2">
                    <img src = "assets/images/element-img-5.png" alt = "">
                </div>
            </footer>
        </div>
        



        <!-- jquery cdn -->
        <script src="https://code.jquery.com/jquery-3.6.4.js" integrity="sha256-a9jBBRygX1Bh5lt8GZjXDzyOB+bWve9EiO7tROUtj/E=" crossorigin="anonymous"></script>
        <!-- owl carousel -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/owl.carousel.min.js" integrity="sha512-bPs7Ae6pVvhOSiIcyUClR7/q2OAsRiovw4vAkX+zJbw3ShAeeqezq50RIIcIURq7Oa20rW2n2q+fyXBNcU9lrw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
        <!-- custom js -->
        <script src = "assets/js/script.js"></script>

        <script>

// Formulaire pour consulter l'historique des consultations
document.getElementById("historiqueConsultationForm").addEventListener("submit", async (event) => {
        event.preventDefault();
        const idDossier = document.getElementById("idDossier").value;

        try {
            const response = await fetch(`http://localhost:8081/suivi-patient/historique-consultation/${idDossier}`);
            if (!response.ok) {
                throw new Error("Erreur lors de la récupération de l'historique.");
            }

            const rendezVous = await response.json();
            if (rendezVous.length === 0) {
                document.getElementById("result").textContent = "Aucun rendez-vous trouvé.";
            } else {
                // document.getElementById("result").textContent = JSON.stringify(rendezVous, null, 2);
                 // Générer le tableau HTML pour plusieurs rendez-vous
            const tableRows = rendezVous.map(rdv => `
                <tr>
                    <td>${rdv.id}</td>
                    <td>${rdv.patient?.nom || "Inconnu"} ${rdv.patient?.prenom || "Inconnu"}</td>
                    <td>${rdv.medecin?.nom || "Inconnu"} ${rdv.medecin?.prenom || "Inconnu"}</td>
                    <td>${rdv.medecin?.specialite || "Non spécifiée"}</td>
                    <td>${rdv.date || "Non spécifiée"}</td>
                    <td>${rdv.heure || "Non spécifiée"}</td>
                    <td>${rdv.status || "Non spécifié"}</td>
                </tr>
            `).join('');

            const table = `
                <table class="table table-striped">
                    <thead class="table-dark">
                        <tr>
                            <th>ID Rendez-vous</th>
                            <th>Nom du Patient</th>
                            <th>Nom du Médecin</th>
                            <th>Spécialité</th>
                            <th>Date</th>
                            <th>Heure</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${tableRows}
                    </tbody>
                </table>
            `;

            document.getElementById("result").innerHTML = table;
            }
        } catch (error) {
            document.getElementById("result").textContent = `Erreur: ${error.message}`;
        }
    });

    // Formulaire pour afficher les rapports
    document.getElementById("affichageRapportForm").addEventListener("submit", async (event) => {
        event.preventDefault();
        const idDossier = document.getElementById("idDossierRapport").value;

        try {
            const response = await fetch(`http://localhost:8081/suivi-patient/rapports/${idDossier}`);
            if (!response.ok) {
                throw new Error("Erreur lors de l'affichage des rapports.");
            }

            const rapports = await response.json();
            if (rapports.length === 0) {
                document.getElementById("result").textContent = "Aucun rapport trouvé.";
            } else {
                document.getElementById("result").textContent = JSON.stringify(rapports, null, 2);
                const tableRows = rapports.map(rdv => `
                <tr>
                    <td>${rdv.id}</td>
                    <td>${rdv.medecinId}</td>
                    <td>${rdv.rapport}</td>
                </tr>
            `).join('');

            const table = `
                <table class="table table-striped">
                    <thead class="table-dark">
                        <tr>
                            <th>ID du rapport</th>
                            <th>ID du médecin</th>
                            <th>Rapport</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${tableRows}
                    </tbody>
                </table>
            `;

            document.getElementById("result").innerHTML = table;
            }
        } catch (error) {
            document.getElementById("result").textContent = `Erreur: ${error.message}`;
        }
    });

    // Formulaire pour changer le statut d'un rendez-vous
    document.getElementById("changerStatusForm").addEventListener("submit", async (event) => {
        event.preventDefault();
        const idRendezVous = document.getElementById("idRendezVous").value;

        try {
            const response = await fetch(`http://localhost:8081/suivi-patient/changer-status?idRendezVous=${idRendezVous}`, {
                method: "POST"
            });

            if (!response.ok) {
                throw new Error("Erreur lors du changement de statut.");
            }

            const result = await response.text();
            document.getElementById("result").textContent = `${result}`;
        } catch (error) {
            document.getElementById("result").textContent = `Erreur: ${error.message}`;
        }
    });



        </script>


    </body>
</html>